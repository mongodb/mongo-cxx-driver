tasks:
  - name: abi-compliance-check
    run_on: ubuntu2204-large
    tags: [abi-stability, abi-compliance-check, ubuntu2204]
    commands:
      - func: abi-compliance-check
  - name: abi-prohibited-symbols
    run_on: ubuntu2204-large
    tags: [abi-stability, abi-prohibited-symbols, ubuntu2204]
    commands:
      - func: abi-prohibited-symbols
  - name: abidiff
    run_on: ubuntu2204-large
    tags: [abi-stability, abidiff, ubuntu2204]
    commands:
      - func: abidiff
  - name: atlas-search-indexes-7.0
    run_on: ubuntu2004-large
    tags: [atlas-search-indexes, ubuntu2004]
    commands:
      - func: install_c_driver
      - func: compile
        vars:
          build_type: Debug
      - func: test-search-index-helpers
  - name: atlas-search-indexes-8.0
    run_on: ubuntu2004-large
    tags: [atlas-search-indexes, ubuntu2004]
    commands:
      - func: install_c_driver
      - func: compile
        vars:
          build_type: Debug
      - func: test-search-index-helpers
  - name: clang-tidy
    run_on: ubuntu2004-small
    tags: [clang-tidy, ubuntu2004]
    commands:
      - func: setup
      - func: install_c_driver
        vars:
          cc_compiler: clang
          cxx_compiler: clang++
      - func: clang-tidy
        vars:
          cc_compiler: clang
          cxx_compiler: clang++
  - name: lint
    run_on: ubuntu1804-large
    tags: [lint, ubuntu1804]
    commands:
      - func: setup
      - func: lint
  - name: stub
    run_on: ubuntu2004-large
    commands:
      - command: subprocess.exec
        params:
          binary: bash
          args:
            - -c
            - "true"
