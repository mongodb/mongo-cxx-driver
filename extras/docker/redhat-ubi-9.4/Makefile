# DO NOT EDIT THIS FILE DIRECTLY
# This file was auto generated from the template file Makefile.j2 using the generate.py script

MONGOCXX_VERSION=3.10.1
DOCKER=docker
DEFAULT_SEARCH_REGISTRY?=docker.io

.PHONY: build
build:
	$(DOCKER) build --build-arg default_search_registry=$(DEFAULT_SEARCH_REGISTRY) . \
		-t mongodb/mongo-cxx-driver:$(MONGOCXX_VERSION)-redhat-ubi-9.4

.PHONY: nocachebuild
nocachebuild:
	$(DOCKER) build --build-arg default_search_registry=$(DEFAULT_SEARCH_REGISTRY) . \
		--no-cache \
		-t mongodb/mongo-cxx-driver:$(MONGOCXX_VERSION)-redhat-ubi-9.4

.PHONY: run
run: | $(filter nocachebuild build, $(MAKECMDGOALS))
	$(DOCKER) run --rm -it mongodb/mongo-cxx-driver:$(MONGOCXX_VERSION)-redhat-ubi-9.4

.PHONY: test
test: | $(filter nocachebuild build, $(MAKECMDGOALS))
	$(DOCKER) build --build-arg default_search_registry=$(DEFAULT_SEARCH_REGISTRY) . \
		--no-cache -f TestDockerfile -t test-mongocxx-driver-image:$(MONGOCXX_VERSION)-redhat-ubi-9.4
	$(DOCKER) run test-mongocxx-driver-image:$(MONGOCXX_VERSION)-redhat-ubi-9.4
