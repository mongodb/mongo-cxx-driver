<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>MongoDB C++ Driver: mongo::PeriodicTask Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MongoDB C++ Driver
   &#160;<span id="projectnumber">legacy-0.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="classmongo_1_1PeriodicTask.html">PeriodicTask</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classmongo_1_1PeriodicTask-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::PeriodicTask Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>these run "roughly" every minute instantiate statically class MyTask : public <a class="el" href="classmongo_1_1PeriodicTask.html" title="these run &quot;roughly&quot; every minute instantiate statically class MyTask : public PeriodicTask { public: ...">PeriodicTask</a> { public: virtual std::string name() const { return "MyTask; " } virtual void doWork() { <a class="el" href="namespacemongo.html#a04e202a89cd646648602a59afd39b4cc" title="Returns a LogstreamBuilder for logging a message with LogSeverity::Log(). ">log()</a> &lt;&lt; "hi" &lt;&lt; endl; } } myTask;  
 <a href="classmongo_1_1PeriodicTask.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="background_8h_source.html">background.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for mongo::PeriodicTask:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="classmongo_1_1PeriodicTask.png" usemap="#mongo::PeriodicTask_map" alt=""/>
  <map id="mongo::PeriodicTask_map" name="mongo::PeriodicTask_map">
<area href="classmongo_1_1DBConnectionPool.html" title="Database connection pool. " alt="mongo::DBConnectionPool" shape="rect" coords="0,56,161,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4baf1230a2bd48b31077aa4ac98388dd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1PeriodicTask.html#a4baf1230a2bd48b31077aa4ac98388dd">startRunningPeriodicTasks</a> ()</td></tr>
<tr class="memdesc:a4baf1230a2bd48b31077aa4ac98388dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> that runs PeriodicTasks.  <a href="#a4baf1230a2bd48b31077aa4ac98388dd">More...</a><br /></td></tr>
<tr class="separator:a4baf1230a2bd48b31077aa4ac98388dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad845aff5c9c99899cc5933a781f32aee"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacemongo.html#a6ee35cd59a3a5a21c98b430345c35401">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1PeriodicTask.html#ad845aff5c9c99899cc5933a781f32aee">stopRunningPeriodicTasks</a> (int gracePeriodMillis)</td></tr>
<tr class="memdesc:ad845aff5c9c99899cc5933a781f32aee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits 'gracePeriodMillis' for the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> responsible for <a class="el" href="classmongo_1_1PeriodicTask.html" title="these run &quot;roughly&quot; every minute instantiate statically class MyTask : public PeriodicTask { public: ...">PeriodicTask</a> execution to finish any running tasks, then destroys it.  <a href="#ad845aff5c9c99899cc5933a781f32aee">More...</a><br /></td></tr>
<tr class="separator:ad845aff5c9c99899cc5933a781f32aee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>these run "roughly" every minute instantiate statically class MyTask : public <a class="el" href="classmongo_1_1PeriodicTask.html" title="these run &quot;roughly&quot; every minute instantiate statically class MyTask : public PeriodicTask { public: ...">PeriodicTask</a> { public: virtual std::string name() const { return "MyTask; " } virtual void doWork() { <a class="el" href="namespacemongo.html#a04e202a89cd646648602a59afd39b4cc" title="Returns a LogstreamBuilder for logging a message with LogSeverity::Log(). ">log()</a> &lt;&lt; "hi" &lt;&lt; endl; } } myTask; </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4baf1230a2bd48b31077aa4ac98388dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mongo::PeriodicTask::startRunningPeriodicTasks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Starts the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> that runs PeriodicTasks. </p>
<p>You may call this multiple times, from multiple threads, and the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> will be started only once. Please note that since this method starts threads, it is not appropriate to call it from within a mongo initializer. Calling this method after calling 'stopRunningPeriodicTasks' does not re-start the background job. </p>

</div>
</div>
<a class="anchor" id="ad845aff5c9c99899cc5933a781f32aee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacemongo.html#a6ee35cd59a3a5a21c98b430345c35401">Status</a> mongo::PeriodicTask::stopRunningPeriodicTasks </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gracePeriodMillis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Waits 'gracePeriodMillis' for the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> responsible for <a class="el" href="classmongo_1_1PeriodicTask.html" title="these run &quot;roughly&quot; every minute instantiate statically class MyTask : public PeriodicTask { public: ...">PeriodicTask</a> execution to finish any running tasks, then destroys it. </p>
<p>If the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> was never started, returns Status::OK right away. If the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> does not terminate within the grace period, returns an invalid status. It is safe to call this method repeatedly from one thread if the grace period is overshot. It is not safe to call this method from multiple threads, or in a way that races with 'startRunningPeriodicTasks'. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/mongo/util/<a class="el" href="background_8h_source.html">background.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
