<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>MongoDB C++ Driver: mongo::BackgroundJob Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MongoDB C++ Driver
   &#160;<span id="projectnumber">legacy-1.0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="classmongo_1_1BackgroundJob.html">BackgroundJob</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classmongo_1_1BackgroundJob-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::BackgroundJob Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Background thread dispatching.  
 <a href="classmongo_1_1BackgroundJob.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="background_8h_source.html">background.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for mongo::BackgroundJob:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="classmongo_1_1BackgroundJob.png" usemap="#mongo::BackgroundJob_map" alt=""/>
  <map id="mongo::BackgroundJob_map" name="mongo::BackgroundJob_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2ed8334ee9751e1ed758d50c5b12a203"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1BackgroundJob.html#a2ed8334ee9751e1ed758d50c5b12a203">go</a> ()</td></tr>
<tr class="memdesc:a2ed8334ee9751e1ed758d50c5b12a203"><td class="mdescLeft">&#160;</td><td class="mdescRight">starts job.  <a href="#a2ed8334ee9751e1ed758d50c5b12a203">More...</a><br /></td></tr>
<tr class="separator:a2ed8334ee9751e1ed758d50c5b12a203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a915bcd20d27f5f4062dbea317c085cfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#a6ee35cd59a3a5a21c98b430345c35401">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1BackgroundJob.html#a915bcd20d27f5f4062dbea317c085cfc">cancel</a> ()</td></tr>
<tr class="memdesc:a915bcd20d27f5f4062dbea317c085cfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the job has not yet started, transitions the job to the 'done' state immediately, such that subsequent calls to 'go' are ignored, and notifies any waiters waiting in 'wait'.  <a href="#a915bcd20d27f5f4062dbea317c085cfc">More...</a><br /></td></tr>
<tr class="separator:a915bcd20d27f5f4062dbea317c085cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75db818af9919b85133bce83109d9b3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1BackgroundJob.html#aa75db818af9919b85133bce83109d9b3">wait</a> (unsigned msTimeOut=0)</td></tr>
<tr class="memdesc:aa75db818af9919b85133bce83109d9b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait for completion.  <a href="#aa75db818af9919b85133bce83109d9b3">More...</a><br /></td></tr>
<tr class="separator:aa75db818af9919b85133bce83109d9b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab7dc04f254a80eddf8d0fe3f2810a125"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1BackgroundJob.html#ab7dc04f254a80eddf8d0fe3f2810a125">BackgroundJob</a> (bool selfDelete=false)</td></tr>
<tr class="memdesc:ab7dc04f254a80eddf8d0fe3f2810a125"><td class="mdescLeft">&#160;</td><td class="mdescRight">sub-class must instantiate the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a>  <a href="#ab7dc04f254a80eddf8d0fe3f2810a125">More...</a><br /></td></tr>
<tr class="separator:ab7dc04f254a80eddf8d0fe3f2810a125"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada59e8d7e8e993947475a815ade1167c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1BackgroundJob.html#ada59e8d7e8e993947475a815ade1167c">run</a> ()=0</td></tr>
<tr class="memdesc:ada59e8d7e8e993947475a815ade1167c"><td class="mdescLeft">&#160;</td><td class="mdescRight">define this to do your work.  <a href="#ada59e8d7e8e993947475a815ade1167c">More...</a><br /></td></tr>
<tr class="separator:ada59e8d7e8e993947475a815ade1167c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Background thread dispatching. </p>
<p>subclass and define <a class="el" href="classmongo_1_1BackgroundJob.html#ada59e8d7e8e993947475a815ade1167c" title="define this to do your work. ">run()</a></p>
<p>It is not possible to run the job more than once. An attempt to call 'go' while the task is running will fail. Calling 'go' after the task has finished are ignored and will not start the job again.</p>
<p>Thread safety: Note that when the job destructs, the thread is not terminated if still running. Generally, if the thread could still be running, allocate the job dynamically and set deleteSelf to true.</p>
<p>The overridden <a class="el" href="classmongo_1_1BackgroundJob.html#ada59e8d7e8e993947475a815ade1167c" title="define this to do your work. ">run()</a> method will be executed on the background thread, so the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> object must exist for as long the background thread is running. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab7dc04f254a80eddf8d0fe3f2810a125"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::BackgroundJob::BackgroundJob </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>selfDelete</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sub-class must instantiate the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selfDelete</td><td>if set to true, object will destruct itself after the <a class="el" href="classmongo_1_1BackgroundJob.html#ada59e8d7e8e993947475a815ade1167c" title="define this to do your work. ">run()</a> finished </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>selfDelete instances cannot be <a class="el" href="classmongo_1_1BackgroundJob.html#aa75db818af9919b85133bce83109d9b3" title="wait for completion. ">wait()</a>-ed upon </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a915bcd20d27f5f4062dbea317c085cfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#a6ee35cd59a3a5a21c98b430345c35401">Status</a> mongo::BackgroundJob::cancel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If the job has not yet started, transitions the job to the 'done' state immediately, such that subsequent calls to 'go' are ignored, and notifies any waiters waiting in 'wait'. </p>
<p>If the job has already been started, this method returns a not-ok status: it does not cancel running jobs. For this reason, you must still call 'wait' on a <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> even after calling 'cancel'. </p>

</div>
</div>
<a class="anchor" id="a2ed8334ee9751e1ed758d50c5b12a203"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mongo::BackgroundJob::go </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>starts job. </p>
<p>returns immediately after dispatching.</p>
<dl class="section note"><dt>Note</dt><dd>the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a> object must live for as long the thread is still running, ie until getState() returns Done. </dd></dl>

</div>
</div>
<a class="anchor" id="ada59e8d7e8e993947475a815ade1167c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void mongo::BackgroundJob::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>define this to do your work. </p>
<p>after this returns, state is set to done. after this returns, deleted if deleteSelf true.</p>
<p>NOTE: if <a class="el" href="classmongo_1_1BackgroundJob.html#ada59e8d7e8e993947475a815ade1167c" title="define this to do your work. ">run()</a> throws, the exception will be caught within 'this' object and will ultimately lead to the <a class="el" href="classmongo_1_1BackgroundJob.html" title="Background thread dispatching. ">BackgroundJob</a>'s thread being finished, as if <a class="el" href="classmongo_1_1BackgroundJob.html#ada59e8d7e8e993947475a815ade1167c" title="define this to do your work. ">run()</a> returned. </p>

</div>
</div>
<a class="anchor" id="aa75db818af9919b85133bce83109d9b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mongo::BackgroundJob::wait </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>msTimeOut</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wait for completion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msTimeOut</td><td>maximum amount of time to wait in milliseconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if did not time out. false otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>you can call <a class="el" href="classmongo_1_1BackgroundJob.html#aa75db818af9919b85133bce83109d9b3" title="wait for completion. ">wait()</a> more than once if the first call times out. but you cannot call wait on a self-deleting job. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/mongo/util/<a class="el" href="background_8h_source.html">background.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
